#!/bin/bash

readarray -t modules < /etc/suspend-modules.conf

case $1 in
  pre)
    for mod in "${modules[@]}"; do
      rmmod $mod
    done
  ;;
  post)
    for mod in "${modules[@]}"; do
      modprobe $mod
    done
  ;;
esac
