
# https://github.com/chromium/chromium/commit/defb3ccfb6685130745cfc65854b4e14092b2ea9
Remove notion of size from NativePixmapEGLX11Binding and friends

---
diff --git a/ui/gl/native_pixmap_egl_x11_binding_helper.cc b/ui/gl/native_pixmap_egl_x11_binding_helper.cc
index 58f874b..53ad9fe 100644
--- a/ui/gl/native_pixmap_egl_x11_binding_helper.cc
+++ b/ui/gl/native_pixmap_egl_x11_binding_helper.cc
@@ -16,8 +16,9 @@ inline EGLDisplay FromXDisplay() {
   return eglGetDisplay(reinterpret_cast<EGLNativeDisplayType>(x_display));
 }
 
-NativePixmapEGLX11BindingHelper::NativePixmapEGLX11BindingHelper()
-    : display_(FromXDisplay()) {}
+NativePixmapEGLX11BindingHelper::NativePixmapEGLX11BindingHelper(
+    const gfx::Size& size)
+    : size_(size), display_(FromXDisplay()) {}
 
 NativePixmapEGLX11BindingHelper::~NativePixmapEGLX11BindingHelper() {
   if (surface_) {
@@ -63,6 +64,10 @@ bool NativePixmapEGLX11BindingHelper::Initialize(x11::Pixmap pixmap) {
   return surface_ != EGL_NO_SURFACE;
 }
 
+gfx::Size NativePixmapEGLX11BindingHelper::GetSize() {
+  return size_;
+}
+
 bool NativePixmapEGLX11BindingHelper::BindTexImage(unsigned target) {
   if (!surface_) {
     return false;
diff --git a/ui/gl/native_pixmap_egl_x11_binding_helper.h b/ui/gl/native_pixmap_egl_x11_binding_helper.h
index 194e540..fe62cb1 100644
--- a/ui/gl/native_pixmap_egl_x11_binding_helper.h
+++ b/ui/gl/native_pixmap_egl_x11_binding_helper.h
@@ -7,6 +7,7 @@
 
 #include <stdint.h>
 
+#include "ui/gfx/geometry/size.h"
 #include "ui/gfx/x/glx.h"
 #include "ui/gl/gl_export.h"
 
@@ -17,7 +18,7 @@ namespace gl {
 
 class GL_EXPORT NativePixmapEGLX11BindingHelper {
  public:
-  NativePixmapEGLX11BindingHelper();
+  explicit NativePixmapEGLX11BindingHelper(const gfx::Size& size);
 
   NativePixmapEGLX11BindingHelper(const NativePixmapEGLX11BindingHelper&) =
       delete;
@@ -26,6 +27,8 @@ class GL_EXPORT NativePixmapEGLX11BindingHelper {
 
   bool Initialize(x11::Pixmap pixmap);
 
+  gfx::Size GetSize();
+
   // Binds image to texture currently bound to |target|. Returns true on
   // success.
   bool BindTexImage(unsigned target);
@@ -37,6 +40,7 @@ class GL_EXPORT NativePixmapEGLX11BindingHelper {
 
  private:
   EGLSurface surface_ = nullptr;
+  const gfx::Size size_;
   EGLDisplay display_;
 };
 
diff --git a/ui/ozone/platform/x11/native_pixmap_egl_x11_binding.cc b/ui/ozone/platform/x11/native_pixmap_egl_x11_binding.cc
index c581b4a..facbce4 100644
--- a/ui/ozone/platform/x11/native_pixmap_egl_x11_binding.cc
+++ b/ui/ozone/platform/x11/native_pixmap_egl_x11_binding.cc
@@ -174,7 +174,8 @@ std::unique_ptr<NativePixmapGLBinding> NativePixmapEGLX11Binding::Create(
     return nullptr;
   }
 
-  auto binding_helper = std::make_unique<gl::NativePixmapEGLX11BindingHelper>();
+  auto binding_helper =
+      std::make_unique<gl::NativePixmapEGLX11BindingHelper>(plane_size);
   x11::Pixmap pixmap =
       gl::XPixmapFromNativePixmap(*native_pixmap, plane_format);
   if (pixmap == x11::Pixmap::None) {
