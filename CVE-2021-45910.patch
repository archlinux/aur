--- a/gif2apng.cpp
+++ b/gif2apng.cpp
@@ -1139,6 +1139,13 @@ int main(int argc, char** argv)
               k = j; if (interlaced) k = (j>h2) ? (j-h2)*2-1 : (j>h2/2) ? (j-h2/2)*4-2 : (j>h2/4) ? (j-h2/4)*8-4 : j*8;
               src = buffer + j*w0;
               dst = frame0 + ((k+y0)*w + x0)*3;
+              if (((j*w0 + w0) > buffer_size) ||
+                  (((((k+y0)*w + x0)*3) + w0 * 3 ) > imagesize) ||
+                  ((((k+y0)*w + x0)*3) < 0 ) ||
+                  ((j*w0) < 0)) {
+                    printf("Something is wrong with the size values\n");
+                    exit(1);
+                   }
               for (i=0; i<w0; i++, src++, dst+=3)
                 if (!has_t || *src != t)
                   memcpy(dst, &pal_l[*src][0], 3);
@@ -1151,6 +1158,13 @@ int main(int argc, char** argv)
               k = j; if (interlaced) k = (j>h2) ? (j-h2)*2-1 : (j>h2/2) ? (j-h2/2)*4-2 : (j>h2/4) ? (j-h2/4)*8-4 : j*8;
               src = buffer + j*w0;
               dst = frame0 + (k+y0)*w + x0;
+              if (((j*w0 + w0) > buffer_size) ||
+                  ((((k+y0)*w + x0) + w0 ) > imagesize) ||
+                  ((((k+y0)*w + x0)) < 0 ) ||
+                  ((j*w0) < 0)) {
+                    printf("Something is wrong with the size values\n");
+                    exit(1);
+              }
               if (shuffle)
               {
                 for (i=0; i<w0; i++, src++, dst++)
