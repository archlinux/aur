#!/bin/sh
source /etc/tinydm.conf

# default to 1000 if none set in config
[ -z "$AUTOLOGIN_UID" ] && AUTOLOGIN_UID=1000
	user=$(getent passwd ${AUTOLOGIN_UID} | cut -d: -f1)
if [ -z "$user" ]; then
	>&2 printf "ERROR: unable to find user with uid $AUTOLOGIN_UID\n"
	exit
fi

mkdir -p /var/lib/tinydm
chown -R tinydm:tinydm /var/lib/tinydm
exec /usr/bin/autologin $user tinydm-run-session
