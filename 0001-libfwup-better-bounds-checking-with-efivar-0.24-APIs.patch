From 9b0258e62c3d5272bb8431f1067042945197b2c8 Mon Sep 17 00:00:00 2001
From: Peter Jones <pjones@redhat.com>
Date: Thu, 25 Feb 2016 14:59:28 -0500
Subject: [PATCH] libfwup: better bounds checking with efivar 0.24 APIs

Signed-off-by: Peter Jones <pjones@redhat.com>
---
 linux/libfwup.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/linux/libfwup.c b/linux/libfwup.c
index 5de9d4c..4154480 100644
--- a/linux/libfwup.c
+++ b/linux/libfwup.c
@@ -695,11 +695,11 @@ do_next:
 			continue;
 		}
 
-		sz = efi_loadopt_pathlen(loadopt);
+		sz = efi_loadopt_pathlen(loadopt, var_data_size);
 		if (sz != efidp_size((efidp)dp_buf))
 			goto do_next;
 
-		efidp found_dp = efi_loadopt_path(loadopt);
+		efidp found_dp = efi_loadopt_path(loadopt, var_data_size);
 		if (memcmp(found_dp, dp_buf, sz))
 			goto do_next;
 
-- 
2.9.0

