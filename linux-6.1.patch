diff --git a/os_dep/osdep_service.c b/os_dep/osdep_service.c
index 7d1ab56..bfc939b 100644
--- a/os_dep/osdep_service.c
+++ b/os_dep/osdep_service.c
@@ -2327,9 +2327,13 @@ inline u32 rtw_random32(void)
 {
 #ifdef PLATFORM_LINUX
 	#if (LINUX_VERSION_CODE >= KERNEL_VERSION(3,8,0))
-	return prandom_u32();
+		#if (LINUX_VERSION_CODE < KERNEL_VERSION(6,1,0))
+			return prandom_u32();
+		#else
+			return get_random_u32();
+		#endif
 	#else
-	return random32();
+		return random32();
 	#endif
 #elif defined(PLATFORM_WINDOWS)
 	#error "to be implemented\n"
