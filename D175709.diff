diff --git a/toolkit/xre/glxtest/glxtest.cpp b/toolkit/xre/glxtest/glxtest.cpp
--- a/toolkit/xre/glxtest/glxtest.cpp
+++ b/toolkit/xre/glxtest/glxtest.cpp
@@ -28,10 +28,14 @@
 #include <vector>
 #include <stdint.h>
 #include <string.h>
 #include <stdarg.h>
 
+#ifdef MOZ_WAYLAND
+#  include <gdk/gdk.h>
+#endif
+
 #if defined(MOZ_ASAN) || defined(FUZZING)
 #  include <signal.h>
 #endif
 
 #ifdef __SUNPRO_CC
@@ -45,10 +49,11 @@
 #endif
 
 #include <vector>
 #include <sys/wait.h>
 #include "mozilla/ScopeExit.h"
+#include "mozilla/Types.h"
 
 #ifdef MOZ_X11
 // stuff from glx.h
 typedef struct __GLXcontextRec* GLXContext;
 typedef XID GLXPixmap;
@@ -1097,10 +1102,16 @@
         break;
       case 'f':
         glxtest_out_pipe = atoi(optarg);
         break;
       case 'h':
+#ifdef MOZ_WAYLAND
+        // Dummy call to mozgtk to prevent the linker from removing
+        // the dependency with --as-needed.
+        // see toolkit/library/moz.build for details.
+        gdk_display_get_default();
+#endif
         PrintUsage();
         return 0;
       default:
         break;
     }

