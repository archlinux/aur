diff --git a/tests/test_stdin.py b/tests/test_stdin.py
index 212b309..c765a00 100644
--- a/tests/test_stdin.py
+++ b/tests/test_stdin.py
@@ -1,11 +1,23 @@
 """Tests for polyfill's stdin monkey patching."""
-import pep8
-import pycodestyle
+import flake8
+try:
+    import pep8
+except ImportError:
+    pep8 = None
+
+try:
+    import pycodestyle
+except ImportError:
+    pycodestyle = None
+
 import pytest
 
 from flake8_polyfill import stdin
 from flake8_polyfill import version
 
+if (4, 0, 0) <= flake8.__version_info__:
+    pytestmark = pytest.mark.skip
+
 
 def test_modules_dict():
     """Verify that it works the way we expect."""
