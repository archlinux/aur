# Generated by gem2arch (https://github.com/anatol/gem2arch)
# Maintainer: Anatoly Bashmakov <anatoly at posteo dot net>
# Maintainer: Grey Christoforo <first name at last name dot net>

_gemname=gollum
pkgname=$_gemname
pkgver=5.2.3
pkgrel=1
pkgdesc='A simple, Git-powered wiki.'
arch=(any)
url='http://github.com/gollum/gollum'
license=(MIT)
depends=(ruby
         ruby-gemojione
         ruby-gollum-lib
         ruby-kramdown
         'ruby-kramdown-parser-gfm>=1.1'
         'ruby-kramdown-parser-gfm<1.2'
         ruby-mustache-sinatra
         'ruby-octicons>=12'
         ruby-rss
         ruby-sass
         ruby-sinatra
         ruby-sinatra-contrib
         'ruby-sprockets<4'
         ruby-sprockets-helpers
         'ruby-uglifier>=4.2'
         ruby-useragent
         'ruby-webrick>=1.7.0')
makedepends=(ruby-rdoc)
options=(!emptydirs)
source=(https://rubygems.org/downloads/$_gemname-$pkgver.gem)
noextract=($_gemname-$pkgver.gem)
sha1sums=('921b3055fad9d5041b9b481e5cca26f7e5b9f188')

package() {
  local _gemdir="$(ruby -e 'puts Gem.default_dir')"
  gem install --ignore-dependencies --no-user-install -i "$pkgdir/$_gemdir" -n "$pkgdir/usr/bin" $_gemname-$pkgver.gem

  # Hack to disable therubyrhino for java platform
  sed -e '/therubyrhino/d' -i $pkgdir/$_gemdir/specifications/$_gemname-$pkgver.gemspec

  rm "$pkgdir/$_gemdir/cache/$_gemname-$pkgver.gem"
  install -D -m644 "$pkgdir/$_gemdir/gems/$_gemname-$pkgver/LICENSE" "$pkgdir/usr/share/licenses/$pkgname/LICENSE"
}
