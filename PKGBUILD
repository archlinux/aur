# Maintainer: Adrian Perez de Castro <aperez@igalia.com>
pkgname=kwebapp
pkgdesc='Generator for front-end and back-end code for Web applications written in C'
pkgver=0.6.9
pkgrel=1
url='https://kristaps.bsd.lv/kwebapp'
license=(custom:BSD)
makedepends=(bc)
depends=(glibc)
optdepends=('ksql: Needed by code generated by kwebapp')
arch=('x86_64')
source=("${url}/snapshots/kwebapp-${pkgver}.tar.gz")
sha512sums=('362f32a9b24aa0a6b170cb298ffb007defb89fb626fd36e28bf48d4502a5ddaea6a057982a8a6b758eba1941ad29d1c643d73a665857760ca104ad4efc723362')

build () {
	cd "${pkgname}-${pkgver}"
	./configure PREFIX=/usr MANDIR=/usr/share/man
	cat >> Makefile.configure <<-EOF
	CFLAGS += ${CFLAGS}
	LDFLAGS += ${LDFLAGS}
	EOF
	make
}

package () {
	cd "${pkgname}-${pkgver}"
	make install DESTDIR="${pkgdir}"
	awk '/^\/\*/,/\*\// { print ; }' main.c > COPYING
	install -Dm644 COPYING "${pkgdir}/usr/share/licenses/${pkgname}/COPYING"
}
