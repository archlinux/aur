# Maintainer: jsteel <mail at jsteel dot org>
# Contributor: nblock <nblock [/at\] archlinux DOT us>
# Contributor: William DÃ­az <wdiaz [at] archlinux [dot] us>
# Contributor: Wolfgang Frisch <xororand@frexx.de>
# Contributor: Leandro Inacio <carvalho.inacio@gmail.com>

# This package is based on gentoo's app-vim/colorschemes.
#
# The source tarball is generated by upstream using the following script:
#   https://github.com/radhermit/gentoo-vim-scripts/blob/master/get-colorschemes

pkgname=vim-colorschemes
pkgver=r150.b8dff40
pkgrel=1
pkgdesc="A very large collection of color schemes from vim.org"
url="http://packages.gentoo.org/package/app-vim/colorschemes"
arch=('any')
conflicts=('vim-colorsamplerpack' 'vim-solarized-git')
depends=('vim')
license=('vim' 'GPL2' 'public-domain' 'as-is')
groups=('vim-plugins')
source=("git+https://github.com/flazz/vim-colorschemes.git#commit=b8dff40f69f1873effbed97c759a8452ecb240ed")
md5sums=('SKIP')

pkgver(){
   cd "$pkgname"
     ( set -o pipefail
         git describe --long 2>/dev/null | sed 's/\([^-]*-g\)/r\1/;s/-/./g' ||
               printf "r%s.%s" "$(git rev-list --count HEAD)" "$(git rev-parse --short HEAD)"
           )

 
}
build() {
  cd "$srcdir"/vim-colorschemes
  # fix line endings
  find . -name '*.vim' -exec sed -i -e 's,\r,\n,g' {} \;
}

package() {
  cd "$srcdir"/vim-colorschemes

  install -dm755 "$pkgdir"/usr/share/vim/vimfiles/colors
  install -m644 colors/* "$pkgdir"/usr/share/vim/vimfiles/colors/

  # delete existing colors
  rm -r "$pkgdir"/usr/share/vim/vimfiles/colors/{blue.vim,delek.vim,desert.vim,torte.vim}
}
