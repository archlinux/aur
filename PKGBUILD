# Maintainer: Ammann Max <maximilian.ammann@googlemail.com>
pkgname=srmio
pkgver=0.1.1~git1
pkgrel=2
pkgdesc="library + command line tools to access a \"Schoberer Rad Messtechnik\" PowerControl V, VI and 7 + read/write their files"
arch=('i686' 'x86_64')
url="http://www.zuto.de/project/srmio/"
license=('custom: Rainer Clasen')
makedepends=('gcc' 'make')
depends=()
options=('!strip' '!buildflags' 'staticlibs')
source=(https://github.com/rclasen/srmio/archive/refs/tags/v0.1.1git1.tar.gz)
md5sums=('09aaa574e130431b1b943329e9029ff0')
pkgverstripped=$(echo $pkgver | sed -r 's/~//g')

build() {
  cd "${srcdir}/srmio-$pkgverstripped/"

  # resurrect a variable that would have been generated by a now obsolete autoconf macro. Noweverdays this is simply always true.
  export ac_cv_header_time=yes
  # package on github does not ship with pre-generated configuration in contrast to the pacakge that was available on zuto.de
  sh ./genautomake.sh

  ./configure --prefix=/usr/
  make -j8
}

package() {
  cd "${srcdir}/srmio-$pkgverstripped/"
  make DESTDIR="$pkgdir/" install
}
