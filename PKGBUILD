_model="large-v3"
_model_sha1sum="ad82bf6a9043ceed055076d0fd39f5f186ff8062"
_pkgbase="whisper.cpp-model"
# Maintainer: Hauke Rehfeld <aur@haukerehfeld.de>
pkgname="${_pkgbase}-${_model}"
pkgver=1
pkgrel=1
pkgdesc="This is an autogenerated file, please see https://github.com/hrehfeld/archlinux-whisper.cpp-model"
arch=("i686" "x86_64")
url="https://github.com/hrehfeld/archlinux-whisper.cpp-model"
license=("GPLv3")

makedepends=()
depends=()
conflicts=()
provides=()

# https://github.com/ggerganov/whisper.cpp/blob/master/models/download-ggml-model.sh
_url="https://huggingface.co/ggerganov/whisper.cpp"
_pfx="blob/main"
_model_file="${_model}.bin"

# https://huggingface.co/ggerganov/whisper.cpp/blob/main/ggml-large-v3.bin
source=("${_model_file}::${_url}/${_pfx}-${_model_file}")
sha1sums=("${_model_sha1sum}")

package() {
  modelpath="/usr/share/$pkgname/${_model_file}"
  install -Dm644 "${srcdir}/${_model_file}" "$pkgdir$modelpath"

  wrapper="whisper.cpp-${_model}"
  echo "#!/bin/sh
/usr/bin/whisper.cpp --model ${modelpath} "\"'$@'\" > "$srcdir/$wrapper"
  install -Dm755 "${srcdir}/$wrapper" "$pkgdir/usr/bin/$wrapper"


}

replaces='whisper.cpp-model-large'