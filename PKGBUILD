# This file has been AUTO-GENERATED by crosspkg utility, which is part of TSPkg project (tssoftware.eu)
# Please do NOT edit by hand


set -e

                baseurl='https://content.tssoftware.eu/scripts/rpk_compat/'; 
                eval "$(curl $baseurl/libcrosspkg.sh)"$'\n'
                eval "$(curl $baseurl/libcrosspkg_remote.sh)"
                export remote=1
            
pkgname='ltstudio'
uniq='tssoftware:ltstudio'
appname='LTStudio'
alias='LT Studio IDE'
pkgdesc='New generation IDE, very fast programming with useful code-completion features for C++, TSML, HTML, Css.  -- Beta version'
author='TS'
type='app'
pkgver='1.0.0'
platforms=( 'all' )
deps=( 'rcore/tssoftware:lib-lt' 'rcore/tssoftware:lib-lt-devel' 'rcore/tssoftware:lib-lt-headers' 'rcore/llvm:libclang' 'rcore/llvm:libs' 'rcore/llvm:llvm' 'rcore/btzy:libnfd' )
groups=( 'Developer/IDE' )
contents=( '/icon.svg<ltstudio.svg' '/data/<./Data' '/data/Plugins/UIEditor/libLTStudio_GuiApp.so<./Plugins/UIEditor/libLTStudio_GuiApp.so' '/data/Plugins/UIEditor/Data<./Plugins/UIEditor/Data' '/data/Plugins/Git/libLTStudio_Git.so<./Plugins/Git/libLTStudio_Git.so' '/data/Plugins/Git/Data<./Plugins/UIEditor/Data' '/conf/<./Config' '/bin<build/bin' '/bin<../LTUiTimestamp/build/bin' '/bin<../LTProjConvert/build/bin' '/bin<../UIToCpp/build/bin' '/bin/oshfclient<oshfclient' )
pkgdir='/tmp/tmp.yQitMjQLk7/sh/pkg'
options=( '!strip' )
pkgrel=1

arch=(  'any' )

depends=( 'lib-lt' 'lib-lt-devel' 'lib-lt-headers' 'clang' 'llvm-libs' 'llvm' 'libnfd' )
makedepends=( rpkdev )
abstorel(){
    sed -E 's/^\/+//g'
}

build() {
    if [ "$remote" == 1 ]; then
        echo "srcdir: $srcdir"
        echo "pkgname: $pkgname"
        cd "$srcdir"
        getpkg "$uniq" "$pkgname" "$pkgver"
    fi
#     [ -f Makefile ] && make -j 4 || ninja
}
run(){
    echo ">>> $@"
    $@
}
package() { 
    echo "Conversion of tspkg started."
    if [ "$remote" == 1 ]; then
        projdir="$srcdir"
    fi
    cd "$projdir/$pkgname"
#     echo "PWD: $PWD"
#     for((i = 0; i < ${#contents[@]}; i++)); do
    dir -1 "./" | while read f; do
#         echo "#contents: ${#contents[@]}"
#         IFS="<" read -a sp <<< "${contents[$i]}"
#         echo "#contents: ${#contents[@]}"
        
#         echo ln -sf "$(trimstr "${sp[1]}")}" "$pkgdir/$(tspkg_convpath "$(trimstr "${sp[0]}")")"
        nativepth="$(tspkg_convpath <<< "$(trimstr "${f}")")"
#         echo "nativepth: $nativepth"
#         echo "pkgdir: $pkgdir"
        mkdir -p "$pkgdir/$(dirname "$nativepth")"
        run cp -R "$(abstorel <<< "${f}")" "$pkgdir/$(abstorel <<< "$nativepth")"
#         cp -R "$(realpath "$(trimstr "${sp[1]}")")" "$pkgdir/$inpkg_path"
    done
    chmod -R 755 "$pkgdir/"
}        
